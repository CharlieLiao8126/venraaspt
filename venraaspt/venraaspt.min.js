var venstrob={v:"1.4.6",strserver:"apid.friday.tw",struuidapi:"/venapis/vengu",strlogapi:"/venapis/log",stract:"action",strcrt:"create",stradd:"add",strrec:"add_rec",stradi:"add_item",strsnd:"send",strall:"all",strwarn:"[warning] venraas ",strnull:"ven_null",strdn:"x",strtoken:"x",strtypeInit:"0",strtypeTracking:"1",strtypeEctrans:"2",strtypeGuid:"3",strtypeSession:"4",venfloctl_processing:"",strDhermesHost:"apih.friday.tw",strDHermesApi:"/hermes/api/goods/rank",strCupidHost:"apir.friday.tw",strCupidKeywordApi:"/cupid/api/goods/keywords"},venfloctl=new Object,venraastool={getcookie:function(t){return theCookie=document.cookie+";",t+="=",start=theCookie.indexOf(t),-1!=start?(end=theCookie.indexOf(";",start),theCookie.substring(start+t.length,end)):""},doCookieSetup:function(t,e,n){try{if(0==n)document.cookie=t+"="+escape(e)+";Path=/;domain="+window.location.host.split(".").slice(-3).join(".");else{var o=new Date;o.setTime(o.getTime()+n),document.cookie=t+"="+escape(e)+";expires="+o.toGMTString()+";Path=/;domain="+window.location.host.split(".").slice(-3).join("."),document.cookie=t+"=; expires="+new Date(0).toGMTString()+"; Path=/"}}catch(t){}},dect_type:function(t,e){return"string"==typeof t&&("object"==typeof e&&void 0)},object_size:function(t){var e=0;for(var n in t)t.hasOwnProperty(n)&&e++;return e},urlparamfactory:function(t,e){var n=[];if("object"!=typeof e)return"";if(t==venstrob.strnull)for(var o in e)n.push(encodeURIComponent(o)+"="+encodeURIComponent(JSON.stringify(e[o])));else n.push(encodeURIComponent(t)+"="+encodeURIComponent(JSON.stringify(e[t])));return n.join("&")},xhr:!window.XMLHttpRequest||"file:"===window.location.protocol&&window.ActiveXObject?function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}:function(){return new window.XMLHttpRequest},getvenuuid:function(t,e){try{var n="?id="+top.location.host+"&typ="+t+"&pt=a";if(window.XDomainRequest&&(navigator.userAgent.indexOf("MSIE 8.0")>0||navigator.userAgent.indexOf("MSIE 9.0")>0))venstrob.venfloctl_processing=e,venraastool.ven_jsonp("https://"+venstrob.strserver+venstrob.struuidapi+n+"&cbk=y");else if(navigator.userAgent.indexOf("MSIE 7.0")>0||navigator.userAgent.indexOf("MSIE 6.0")>0)venstrob.venfloctl_processing=e,venraastool.ven_jsonp("https://"+venstrob.strserver+venstrob.struuidapi+n+"&cbk=y");else{var o;(o=venraastool.xhr()).open("GET","https://"+venstrob.strserver+venstrob.struuidapi+n,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),o.withCredentials=!0,o.onreadystatechange=function(){try{4==o.readyState&&200==o.status&&(vencontrob.vencookiecontr(t,o.responseText),"s"==t?vencontrob.actioncontroller(e):venfloctl[e].status=!0)}catch(t){}},o.send()}}catch(t){}},isarray:function(t){return!!t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice&&!t.propertyIsEnumerable("length")},ven_jsonp:function(t){try{var e=document.createElement("script");e.setAttribute("src",t),document.body.appendChild(e)}catch(t){}},recomd:function(t,e){var n=venraastool.getcookie("venguid");if(""==n&&void 0!==venfloctl){var o=venraastool.object_size(venfloctl);venfloctl[o]={},venfloctl[o].status=!1,venfloctl[o].contr="",venfloctl[o].venact="",venfloctl[o].objv="",venfloctl[o].type=venstrob.strtypeGuid,venfloctl[o].retry=0,venraas.ven_cps(o)}var r=venraastool.getcookie("vensession");if(""==r&&void 0!==venfloctl){o=venraastool.object_size(venfloctl);venfloctl[o]={},venfloctl[o].status=!1,venfloctl[o].contr="",venfloctl[o].venact="",venfloctl[o].objv="",venfloctl[o].type=venstrob.strtypeSession,venfloctl[o].retry=0,venraas.ven_cps(o)}t.ven_guid=n,t.ven_session=r;var s=venraastool.xhr();s.onreadystatechange=function(){try{4==this.readyState&&200==this.status&&e(this.responseText,t)}catch(t){console.log(t.message)}},s.open("POST","https://"+venstrob.strDhermesHost+venstrob.strDHermesApi,!0),s.setRequestHeader("Content-type","application/json; charset=UTF-8"),s.withCredentials=!0;var a=JSON.stringify(t);s.send(a)},goods_keywords:function(t,e){var n=venraastool.xhr();n.onreadystatechange=function(){try{4==this.readyState&&200==this.status&&e(this.responseText)}catch(t){console.log(t.message)}},n.open("POST","https://"+venstrob.strCupidHost+venstrob.strCupidKeywordApi,!0),n.setRequestHeader("Content-type","application/json; charset=UTF-8"),n.withCredentials=!0;var o=JSON.stringify(t);n.send(o)}},vencontrob={createcontr:function(t,e){this.creadata(t),this.setpdata(t,venstrob.stract,t),this.addcontr(t,e)},addcontr:function(t,e){for(var n in e)this.setpdata(t,n,e[n])},addrecitemcontr:function(t,e){venraastool.isarray(this.pdata[t].now_rec)||(this.pdata[t].now_rec=new Array);var n=this.pdata[t].now_rec.length;this.pdata[t].now_rec[n]=e},addtritemcontr:function(t,e){venraastool.isarray(this.pdata[t].trans_i.ilist)||(this.pdata[t].trans_i.ilist=new Array);var n=this.pdata[t].trans_i.ilist.length;this.pdata[t].trans_i.ilist[n]=e},sendcontr:function(t){t==venstrob.strall?this.apirequest(venstrob.strnull):this.apirequest(t)},autoretrieve:function(t){this.setpdata(t,"para",location.search),this.setpdata(t,"uri",location.pathname),this.setpdata(t,"client_host",venstrob.strdn),this.setpdata(t,"token",venstrob.strtoken),this.setpdata(t,"tophost",top.location.host),this.setpdata(t,"referrer",document.referrer);try{this.setpdata(t,"client_tzo",(new Date).getTimezoneOffset()),this.setpdata(t,"client_utc",(new Date).getTime())}catch(t){}this.setpdata(t,"ven_guid",venraastool.getcookie("venguid")),this.setpdata(t,"ven_session",venraastool.getcookie("vensession")),this.setpdata(t,"ver",venstrob.v);var e=this.getpdata(t,"from_rec");e&&"null"!=e||(e=new URL(location.href).searchParams.get("from_rec"))&&this.setpdata(t,"from_rec",e)},pdata:new Object,creadata:function(t){this.pdata[t]={}},getpdata:function(t,e){return this.pdata[t]?this.pdata[t][e]:void 0},setpdata:function(t,e,n){void 0!==this.pdata[t]?this.pdata[t][e]=n:(this.pdata[t]={},this.pdata[t][e]=n)},delpdata:function(t){t==venstrob.strnull?this.pdata={}:this.pdata[t]={}},apirequest:function(t){var e,n=venraastool.urlparamfactory(t,this.pdata);if(""!==n)try{window.XDomainRequest&&(navigator.userAgent.indexOf("MSIE 8.0")>0||navigator.userAgent.indexOf("MSIE 9.0")>0)?venraastool.ven_jsonp("https://"+venstrob.strserver+venstrob.strlogapi+"?"+n):navigator.userAgent.indexOf("MSIE 7.0")>0||navigator.userAgent.indexOf("MSIE 6.0")>0?venraastool.ven_jsonp("https://"+venstrob.strserver+venstrob.strlogapi+"?"+n):((e=venraastool.xhr()).open("POST","https://"+venstrob.strserver+venstrob.strlogapi,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),e.withCredentials=!0,e.onreadystatechange=function(){try{4==e.readyState&&e.status}catch(t){}},e.send(n))}catch(t){}},actioncontroller:function(t){var e=venfloctl[t].contr,n=venfloctl[t].venact,o=venfloctl[t].objv;switch(e){case venstrob.strcrt:var r=!0;0==o.autosend&&(r=!1),vencontrob.createcontr(n,o),vencontrob.autoretrieve(n),1==r&&vencontrob.sendcontr(n);break;case venstrob.stradd:vencontrob.addcontr(n,o);break;case venstrob.strsnd:vencontrob.sendcontr(n);break;case venstrob.strrec:vencontrob.addrecitemcontr(n,o)}venfloctl[t].status=!0},vencookiecontr:function(t,e){"g"==t?venraastool.doCookieSetup("venguid",e,31536e7):"s"==t&&venraastool.doCookieSetup("vensession",e,18e5)}};function vengujsonpcallbk(t,e){try{vencontrob.vencookiecontr(t,e),"s"==t?vencontrob.actioncontroller(venstrob.venfloctl_processing):venfloctl[venstrob.venfloctl_processing].status=!0}catch(t){}}var venraas={init:function(t){try{if(void 0!==t&&void 0!==t.domainName&&(venstrob.strdn=t.domainName),void 0!==t&&void 0!==t.token&&(venstrob.strtoken=t.token),null===document.getElementById("venraasfr")){var e=document.createElement("iframe");e.setAttribute("id","venraasfr"),e.style.display="none",e.style.width="1px",e.style.height="1px",e.style.border="0px",e.style.padding="0px",e.style.margin="0px",e.src="https://"+venstrob.strserver+venstrob.struuidapi,void 0===t||void 0===t.tagID?document.body.appendChild(e):null!==document.getElementById(t.tagID)?document.getElementById(t.tagID).appendChild(e):console.log("[Error] venraas document.getElementById("+t.tagID+") is not exist!")}if(""==venraastool.getcookie("venguid")&&void 0!==venfloctl){var n=venraastool.object_size(venfloctl);venfloctl[n]={},venfloctl[n].status=!1,venfloctl[n].contr="",venfloctl[n].venact="",venfloctl[n].objv="",venfloctl[n].type=venstrob.strtypeGuid,venfloctl[n].retry=0,this.ven_cps(n)}}catch(t){}},tracking:function(t,e){try{if(void 0===e&&(e={}),0==venraastool.dect_type(t,e))return;var n="",o="";if(t.indexOf("|")>-1?(cmdar=t.split("|"),n=cmdar[0],o=cmdar[1]):(n=venstrob.strall,o=t),void 0!==venfloctl){var r=venraastool.object_size(venfloctl);venfloctl[r]={},venfloctl[r].status=!1,venfloctl[r].contr=o,venfloctl[r].venact=n,venfloctl[r].objv=e,venfloctl[r].type=venstrob.strtypeTracking,venfloctl[r].retry=0,this.ven_cps(r)}}catch(t){}},ven_tracking:function(t){""==venraastool.getcookie("vensession")?venraastool.getvenuuid("s",t):(venraastool.doCookieSetup("vensession",venraastool.getcookie("vensession"),18e5),vencontrob.actioncontroller(t))},ven_cps:function(t){try{if(0==t||venfloctl[t-1].status)switch(venfloctl[t].type){case venstrob.strtypeTracking:venraas.ven_tracking(t);break;case venstrob.strtypeEctrans:venraas.ven_ecTransaction(t);break;case venstrob.strtypeGuid:venraastool.getvenuuid("g",t);break;case venstrob.strtypeSession:venraastool.getvenuuid("s",t)}else venfloctl[t].retry<3&&(venfloctl[t].retry++,setTimeout("venraas.ven_cps("+t+")",100))}catch(t){}},ecTransaction:function(t,e){try{if(void 0===e&&(e={}),0==venraastool.dect_type(t,e))return;var n="",o="";if(t.indexOf("|")>-1&&(cmdar=t.split("|"),n=cmdar[0],o=cmdar[1]),void 0!==venfloctl){var r=venraastool.object_size(venfloctl);venfloctl[r]={},venfloctl[r].status=!1,venfloctl[r].contr=o,venfloctl[r].venact=n,venfloctl[r].objv=e,venfloctl[r].type=venstrob.strtypeEctrans,venfloctl[r].retry=0,this.ven_cps(r)}}catch(t){}},ven_ecTransaction:function(t){var e=venfloctl[t].contr,n=venfloctl[t].objv,o=venfloctl[t].venact;switch(e){case venstrob.stradd:n.ilist={};var r=new Object;r.trans_i=n,vencontrob.addcontr(o,r);break;case venstrob.stradi:vencontrob.addtritemcontr(o,n);break;default:console.log(venstrob.strwarn+":input exception. c3")}venfloctl[t].status=!0}};